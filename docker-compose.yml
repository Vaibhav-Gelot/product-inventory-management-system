version: "3"
services:
  inventory_service:
    container_name: inventory_service
    image: product-inventory-management-system
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "3000:3000"
    environment:
      NODE_ENV: development
    depends_on:
      - postgres_database
      - redis_database
  postgres_database:
      container_name: postgres_database
      image: postgres:14-alpine
      restart: always
      expose:
        - "5431"
      ports:
        - "5431:5431"
      command: -p 5431
      environment:
        POSTGRES_DB: product_inventory
        POSTGRES_USER: postgres
        POSTGRES_PASSWORD: root
        PGDATA: /data/postgres
      volumes:
          - product_inventory_postgres:/data/postgres
  redis_database:
      container_name: redis_database
      image: redis:alpine
      restart: always
      expose:
        - "6379"
      ports:
        - "6379:6379"
      command: redis-server --save 20 1 --loglevel warning
      volumes:
          - ./etc/redis/redis.conf:/etc/redis/redis.conf
          - product_inventory_redis:/data
volumes:
  product_inventory_postgres:
    external: false
  product_inventory_redis:
    external: false
